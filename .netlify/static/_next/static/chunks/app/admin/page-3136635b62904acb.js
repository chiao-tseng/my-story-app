(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1672:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(5155);function n(e){var t;let{status:s}=e,n={published:{text:"已發布",cls:"bg-green-100 text-green-700 border-green-200"},pending:{text:"待審核",cls:"bg-amber-100 text-amber-700 border-amber-200"},rejected:{text:"已退稿",cls:"bg-red-100 text-red-700 border-red-200"},withdrawn:{text:"已撤稿",cls:"bg-slate-100 text-slate-700 border-slate-200"}},r=null!=(t=n[s])?t:n.published;return(0,a.jsx)("span",{className:"inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium ".concat(r.cls),children:r.text})}},2563:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5155),n=s(2115),r=s(1672);function l(){let[e,t]=(0,n.useState)(""),[s,l]=(0,n.useState)(!1),[i,d]=(0,n.useState)("pending"),[c,o]=(0,n.useState)([]),[x,h]=(0,n.useState)(!1);async function u(t){t.preventDefault(),h(!0);let s=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})});h(!1),s.ok?(l(!0),m()):alert("密碼錯誤")}async function p(){await fetch("/api/admin/logout",{method:"POST"}),l(!1),o([])}async function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=await fetch("/api/admin/stories?status=".concat(e),{cache:"no-store"});t.ok?(o((await t.json()).stories||[]),l(!0)):l(!1)}async function b(e,t){(await fetch("/api/admin/stories/".concat(e,"/").concat(t),{method:"POST"})).ok?m():alert("操作失敗")}return(0,n.useEffect)(()=>{m()},[i]),(0,a.jsxs)("main",{className:"mx-auto max-w-5xl px-6 py-10",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"管理後台"}),!s&&(0,a.jsxs)("form",{onSubmit:u,className:"max-w-sm space-y-3",children:[(0,a.jsx)("input",{type:"password",value:e,onChange:e=>t(e.target.value),placeholder:"輸入管理密碼",className:"w-full border p-3 rounded-lg"}),(0,a.jsx)("button",{disabled:x,className:"rounded-lg bg-blue-600 text-white px-4 py-2",children:x?"登入中…":"登入"})]}),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"flex gap-2",children:["pending","published","rejected","withdrawn"].map(e=>(0,a.jsx)("button",{onClick:()=>d(e),className:"px-3 py-1.5 rounded ".concat(i===e?"bg-black text-white":"border"),children:"pending"===e?"待審核":"published"===e?"已發布":"rejected"===e?"已退稿":"已撤稿"},e))}),(0,a.jsx)("button",{onClick:p,className:"text-gray-600 underline",children:"登出"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[c.map(e=>(0,a.jsxs)("div",{className:"border rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[new Date(e.createdAt).toLocaleString()," \xb7 ",e.id]}),(0,a.jsx)(r.A,{status:e.status})]}),(0,a.jsx)("h2",{className:"font-semibold mb-2",children:e.persona||"未命名角色"}),(0,a.jsx)("p",{className:"whitespace-pre-wrap text-gray-800",children:e.content}),"pending"===i?(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>b(e.id,"publish"),className:"px-3 py-1.5 rounded bg-green-600 text-white hover:bg-green-700",children:"發布"}),(0,a.jsx)("button",{onClick:()=>b(e.id,"reject"),className:"px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700",children:"退稿"})]}):"published"===i?(0,a.jsx)("div",{className:"mt-3 flex gap-2",children:(0,a.jsx)("button",{onClick:()=>b(e.id,"withdraw"),className:"px-3 py-1.5 rounded bg-gray-600 text-white hover:bg-gray-700",children:"撤稿"})}):"rejected"===i?(0,a.jsx)("div",{className:"mt-3 flex gap-2",children:(0,a.jsx)("button",{onClick:()=>b(e.id,"republish"),className:"px-3 py-1.5 rounded bg-green-600 text-white hover:bg-green-700",children:"重新發布"})}):"withdrawn"===i?(0,a.jsx)("div",{className:"mt-3 flex gap-2",children:(0,a.jsx)("button",{onClick:()=>b(e.id,"republish"),className:"px-3 py-1.5 rounded bg-green-600 text-white hover:bg-green-700",children:"重新發布"})}):null]},e.id)),0===c.length&&(0,a.jsx)("div",{className:"text-gray-500",children:"沒有資料。"})]})]})]})}},6244:(e,t,s)=>{Promise.resolve().then(s.bind(s,2563))}},e=>{e.O(0,[441,255,358],()=>e(e.s=6244)),_N_E=e.O()}]);