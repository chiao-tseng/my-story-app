(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[977],{63:(e,s,t)=>{"use strict";var r=t(7260);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},141:(e,s,t)=>{Promise.resolve().then(t.bind(t,1871))},1871:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(5155),a=t(63),l=t(2115);function n(){let e=(0,a.useRouter)(),s=(0,a.useSearchParams)().get("storyId")||"",[t,n]=(0,l.useState)(!1),[o,c]=(0,l.useState)(null);async function u(t){t.preventDefault(),n(!0);let r=new FormData(t.currentTarget),a={storyId:s||r.get("storyId"),requesterContact:r.get("requesterContact"),message:r.get("message")},l=await fetch("/api/contact-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(n(!1),!l.ok)return void alert("送出失敗，請檢查欄位");alert("已送出聯繫需求。我們會盡快回覆你。"),e.push("/stories")}return(0,l.useEffect)(()=>{s&&fetch("/api/stories/".concat(s)).then(e=>e.json()).then(e=>{e.id&&c({id:e.id,persona:e.persona})}).catch(()=>{c(null)})},[s]),(0,r.jsxs)("main",{className:"mx-auto max-w-3xl px-6 py-10",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"聯繫出版社"}),o&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsx)("h2",{className:"font-semibold text-blue-900 mb-1",children:"關於這篇故事"}),(0,r.jsxs)("p",{className:"text-blue-800",children:[(0,r.jsx)("strong",{children:"角色："}),o.persona]}),(0,r.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"你的聯繫需求將與這篇故事關聯"})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:o?"如果你對這篇故事有疑問或想與投稿者進一步溝通，請填寫以下資訊。":"如果你對某篇故事有疑問或想與投稿者進一步溝通，請填寫以下資訊。"}),(0,r.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[s&&(0,r.jsx)("input",{type:"hidden",name:"storyId",value:s}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"requesterContact",className:"block text-sm font-medium text-gray-700 mb-2",children:"你的聯絡方式 *"}),(0,r.jsx)("input",{id:"requesterContact",name:"requesterContact",required:!0,placeholder:"Email、電話、Line ID 皆可",className:"w-full border p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"想了解的重點或說明"}),(0,r.jsx)("textarea",{id:"message",name:"message",rows:6,placeholder:"請說明你想了解的重點，例如：想確認是否為當事人、想了解更多細節等...",className:"w-full border p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsx)("button",{disabled:t,type:"submit",className:"w-full rounded-xl bg-blue-600 text-white py-3 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"送出中…":"送出聯繫需求"})]}),!o&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"如何關聯特定故事？"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"如果你想針對特定故事提出聯繫需求，請先到故事列表頁面，點擊該故事下方的「聯繫出版社」連結。"})]})]})}function o(){return(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{children:"載入中..."}),children:(0,r.jsx)(n,{})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=141)),_N_E=e.O()}]);